{"version":3,"sources":["utils/firebase.js","pages/Register/schema.config.js","providers/UserContext.jsx","pages/Login/Login.jsx","components/VideoJS.jsx","pages/Livestream/_Chat.jsx","pages/Livestream/Livestream.jsx","pages/Register/Register.jsx","utils/routes.jsx","App.jsx","index.js"],"names":["instance","schema","yup","shape","username","email","required","password","min","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","getFirebase","window","firebase","initializeApp","UserContext","createContext","UserContextProvider","children","useState","currentUser","setCurrentUser","Provider","value","Register","props","userContext","useContext","history","useHistory","formOptions","mode","reValidateMode","resolver","yupResolver","useForm","handleSubmit","register","setLoading","makeRequest","reqData","a","auth","signInWithEmailAndPassword","then","userCredential","console","log","user","push","catch","error","authenticated","initializing","authentication","setAuthState","useEffect","onAuthStateChanged","to","className","action","onSubmit","formData","htmlFor","type","name","id","minLength","message","VideoJS","videoRef","React","useRef","options","VideoHtml","ref","crossOrigin","player","videoElement","current","videojs","dispose","Chat","socket","setSocket","newSocket","io","close","setUsername","connected","setConnected","messages","setMessages","userNum","setUserNum","inputRef","emit","on","data","numUsers","addChatMessage","now","Date","dateArr","toLocaleString","split","time","length","messagesEndRef","scrollIntoView","behavior","map","msg","photoUrl","src","alt","e","preventDefault","placeholder","Livestream","videoSrc","setVideoSrc","getIdToken","idToken","fetch","method","headers","Authorization","res","json","url","signOut","handleLogout","videoJsOptions","autoplay","controls","responsive","liveui","fluid","sources","onClick","createUserWithEmailAndPassword","ROUTES","path","key","exact","protected","component","Login","RenderRoutes","routes","route","i","render","App","ReactDOM","document","getElementById"],"mappings":"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","file":"static/js/main.ff7041cb.chunk.js","sourcesContent":["import firebase from 'firebase';\n\nvar firebaseConfig = {\n  apiKey: 'AIzaSyCDN0Hii6Mznt2Y_DaRprMWVn7kwR9-xlY',\n  authDomain: 'larincam.firebaseapp.com',\n  projectId: 'larincam',\n  storageBucket: 'larincam.appspot.com',\n  messagingSenderId: '70794209044',\n  appId: '1:70794209044:web:1f0ccefcdfb498f5fcc401',\n};\n// Initialize Firebase\nlet instance;\n\nexport default function getFirebase() {\n  if (typeof window !== 'undefined') {\n    if (instance) return instance;\n    instance = firebase.initializeApp(firebaseConfig);\n    return instance;\n  }\n\n  return null;\n}\n","import * as yup from 'yup';\n/**\n * Schema contains validation functions for each input.\n */\nconst schema = yup.object().shape({\n  username: yup.string().email().required('Username is a required field.'),\n  password: yup\n    .string()\n    .min(6, 'Password must be at least 6 characters long.')\n    .required('Password is a required field.'), // we should define some password rules here\n});\n\nexport default schema;\n","import React, { createContext, useState } from 'react';\nimport firebase from 'firebase';\n\nexport const UserContext = createContext(null);\n\nfunction UserContextProvider({ children }) {\n  const [currentUser, setCurrentUser] = useState(null);\n  return (\n    <UserContext.Provider value={{ currentUser, setCurrentUser }}>\n      {children}\n    </UserContext.Provider>\n  );\n}\n\nexport default UserContextProvider;\n","import React, { useState, useEffect, useContext } from 'react';\nimport { useForm, UseFormProps, SubmitHandler } from 'react-hook-form';\nimport { Redirect, useHistory } from 'react-router-dom';\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport schema from '../Register/schema.config';\nimport getFirebase from '../../utils/firebase';\n\nimport { UserContext } from '../../providers/UserContext';\n\nfunction Register(props) {\n  const userContext = useContext(UserContext);\n  const history = useHistory();\n  const firebase = getFirebase();\n\n  const formOptions = {\n    mode: 'onSubmit',\n    reValidateMode: 'onChange',\n    resolver: yupResolver(schema),\n  };\n\n  const { handleSubmit, register } = useForm(formOptions);\n\n  const [loading, setLoading] = useState(false);\n\n  const prepareRequest = (formData) => {\n    const { password, username } = formData;\n    const reqData = {\n      username,\n      password,\n    };\n\n    makeRequest(reqData);\n  };\n\n  const makeRequest = async (reqData) => {\n    setLoading(true);\n\n    const { username, password } = reqData;\n\n    firebase\n      .auth()\n      .signInWithEmailAndPassword(username, password)\n      .then((userCredential) => {\n        setLoading(false);\n        console.log(userCredential);\n        const user = userCredential.user;\n        userContext.setCurrentUser(user);\n        history.push('/');\n      })\n      .catch((error) => {\n        console.error(error);\n      });\n  };\n\n  const [authentication, setAuthState] = useState({\n    authenticated: false,\n    initializing: true,\n  });\n\n  useEffect(\n    () =>\n      firebase.auth().onAuthStateChanged((user) => {\n        console.log('USER', user);\n        if (user) {\n          setAuthState({\n            authenticated: true,\n            initializing: false,\n          });\n        } else {\n          setAuthState({\n            authenticated: false,\n            initializing: false,\n          });\n        }\n      }),\n    [setAuthState]\n  );\n\n  if (authentication.authenticated) {\n    return <Redirect to='/' />;\n  }\n\n  return (\n    <div className='container'>\n      <h1>Sign in</h1>\n      <form\n        action=''\n        onSubmit={handleSubmit(prepareRequest)}\n        className='mt-3 col-12 col-md-5 mx-auto'\n      >\n        <div className='form-group'>\n          <label htmlFor='username'>Email</label>\n          <input\n            {...register('username')}\n            type='text'\n            name='username'\n            className={`form-control rounded mt-2`}\n            id='username'\n          />\n        </div>\n\n        <div className='form-group'>\n          <label htmlFor='password'>Password</label>\n          <input\n            {...register('password', {\n              minLength: {\n                value: 6,\n                message: 'Password length must be at least 6 characters',\n              },\n            })}\n            type='password'\n            name='password'\n            className={`form-control rounded mt-2`}\n            id='password'\n          />\n        </div>\n\n        <button className='btn btn-primary mt-4 w-100' type='submit'>\n          Register\n        </button>\n      </form>\n    </div>\n  );\n}\n\nRegister.propTypes = {};\n\nexport default Register;\n","import React from 'react';\nimport videojs from 'video.js';\nimport 'video.js/dist/video-js.css';\nimport '@videojs/themes/dist/city/index.css';\n\nexport const VideoJS = (props) => {\n  const videoRef = React.useRef(null);\n  const { options } = props;\n\n  // This seperate functional component fixes the removal of the videoelement\n  // from the DOM when calling the dispose() method on a player\n  const VideoHtml = (props) => (\n    <div data-vjs-player>\n      <video\n        ref={videoRef}\n        className='video-js vjs-theme-city vjs-big-play-centered'\n        crossOrigin='anonymous'\n      />\n    </div>\n  );\n\n  React.useEffect(() => {\n    const videoElement = videoRef.current;\n    let player;\n    if (videoElement) {\n      player = videojs(videoElement, options, () => {});\n    }\n    return () => {\n      if (player) {\n        player.dispose();\n      }\n    };\n  }, [options]);\n\n  return <VideoHtml />;\n};\nexport default VideoJS;\n","import React, { useState, useEffect, useRef } from 'react';\nimport PropTypes from 'prop-types';\nimport { io } from 'socket.io-client';\nimport getFirebase from '../../utils/firebase'\n\nconst COLORS = [\n  '#e21400',\n  '#91580f',\n  '#f8a700',\n  '#f78b00',\n  '#58dc00',\n  '#287b00',\n  '#a8f07a',\n  '#4ae8c4',\n  '#3b88eb',\n  '#3824aa',\n  '#a700ff',\n  '#d300e7',\n];\n\nfunction Chat(props) {\n  \n\n  const [socket, setSocket] = useState(null);\n\n  useEffect(() => {\n    const newSocket = io('ws://chat.larin.cam');\n    setSocket(newSocket);\n\n    return () => newSocket.close();\n  }, [setSocket]);\n\n  useEffect(() => {\n    const user = getFirebase().auth().currentUser\n    setUsername(user.email)\n  }, [])\n\n  const [connected, setConnected] = useState(false);\n  const [typing, setTyping] = useState(false);\n  const [username, setUsername] = useState(\"\");\n  const [messages, setMessages] = useState([]);\n  const [userNum, setUserNum] = useState(0);\n\n  const inputRef = useRef();\n\n  if(socket) {\n      socket.emit('add user', username);\n\n      socket.on('login', (data) => {\n\n      setUserNum(data.numUsers);\n      setConnected(true)\n    });\n\n    // Whenever the server emits 'new message', update the chat body\n    socket.on('new message', (data) => {\n      addChatMessage(data);\n    });\n\n    // Whenever the server emits 'user joined', log it in the chat body\n    socket.on('user joined', (data) => {\n      setUserNum(data.numUsers);\n    });\n\n    // Whenever the server emits 'user left', log it in the chat body\n    socket.on('user left', (data) => {\n      setUserNum(data.numUsers);\n    });\n\n    // Whenever the server emits 'stop typing', kill the typing message\n\n    socket.on('disconnect', () => {\n      // log('you have been disconnected');\n    });\n\n    socket.on('reconnect', () => {\n      if (username) {\n        socket.emit('add user', username);\n      }\n    });\n  }\n\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    let message = inputRef.current.value;\n    // Prevent markup from being injected into the message\n    // if there is a non-empty message and a socket connection\n    if (message && connected) {\n      inputRef.current.value = '';\n      addChatMessage({ username, message });\n      // tell server to execute 'new message' and send along one parameter\n      socket.emit('new message', message);\n    }\n  };\n\n\n  const addChatMessage = (data, options = {}) => {\n    const now = new Date();\n    const dateArr = now.toLocaleString(\"cs\").split(\" \");\n    setMessages([...messages, {\n      username: data.username,\n      message: data.message,\n      time: dateArr[dateArr.length-1],\n    }]);\n  };\n\n  const getUsernameColor = (username) => {\n    // Compute hash code\n    let hash = 7;\n    for (let i = 0; i < username.length; i++) {\n      hash = username.charCodeAt(i) + (hash << 5) - hash;\n    }\n    // Calculate color\n    const index = Math.abs(hash % COLORS.length);\n    return COLORS[index];\n  };\n\n  const messagesEndRef = useRef(null);\n\n  const scrollToBottom = () => {\n    messagesEndRef.current.scrollIntoView({ behavior: \"smooth\" });\n  };\n\n  useEffect(scrollToBottom, [messages]);\n\n  const renderMessages = () => {\n    return messages.map((msg) => {\n      const { username, message, time, photoUrl } = msg;\n      return (\n        <div className='message d-flex mb-3 align-items-center'>\n          <img src=\"https://www.makeyoutubevideo.com/assets/img/avatar.jpg\" alt='' className='me-2' />\n          <div className='d-flex flex-column align-items-start'>\n            <span className='username'>{username}</span>\n            <p className='message-text'>{message}</p>\n          </div>\n        </div>\n      );\n    });\n  };\n\n  const getWatcherString = () => {\n    if(userNum === 1) {\n      return `${userNum} DIVÁK`\n    }\n    else if(userNum <= 4) {\n      return `${userNum} DIVÁCI`\n    }\n    return `${userNum} DIVÁKŮ`\n  }\n\n  return (\n    <div className='chat'>\n      <div className='chat-header d-flex justify-content-between'>\n        <span>CHAT</span>\n        <span>{getWatcherString()}</span>\n      </div>\n      <div className='chat-body'>\n        {renderMessages()}\n        <div ref={messagesEndRef} />\n      </div>\n      <div className='chat-footer'>\n        <form action='' onSubmit={handleSubmit}>\n          <div className='form-group d-flex'>\n            <input\n              type='text'\n              ref={inputRef}\n              placeholder='Zpráva'\n              className='w-100'\n            />\n            <button className='btn btn-primary'>SEND</button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}\n\nChat.propTypes = {};\n\nexport default Chat;\n","import React, { useEffect, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { Redirect } from 'react-router-dom';\n\nimport VideoJS from '../../components/VideoJS';\nimport getFirebase from '../../utils/firebase';\n\nimport Chat from './_Chat';\n\nimport './livestream.scss';\n\nfunction Livestream(props) {\n  let firebase = getFirebase();\n\n  const [videoSrc, setVideoSrc] = useState('null');\n\n  useEffect(() => {\n    firebase\n      .auth()\n      .currentUser.getIdToken(/* forceRefresh */ true)\n      .then(function (idToken) {\n        fetch('https://larin.cam/issue-stream-url', {\n          method: 'GET',\n          headers: {\n            Authorization: `Bearer ${idToken}`,\n            'Access-Control-Allow-Origin': '*',\n            'Access-Control-Allow-Methods': '*',\n            'Access-Control-Allow-Headers': '*',\n          },\n        }).then((res) => {\n          res.json().then((url) => {\n            setVideoSrc(url.data);\n          });\n        });\n      })\n      .catch(async function (error) {\n        await firebase.auth().signOut();\n      });\n  }, []);\n\n  const handleLogout = async () => {\n    await firebase.auth().signOut();\n  };\n\n  console.log('SRC', videoSrc);\n\n  const videoJsOptions = {\n    // lookup the options in the docs for more options\n    autoplay: true,\n    controls: true,\n    responsive: true,\n    liveui: true,\n    fluid: true,\n    sources: [\n      {\n        src: videoSrc,\n        type: 'application/x-mpegURL',\n      },\n    ],\n  };\n\n  if (!videoSrc) {\n    return <div>Loading...</div>;\n  }\n\n  return (\n    <div className='container'>\n      Livestream\n      <div className='row'>\n        <div className='col-12 col-lg-9'>\n          <div className='video-wrapper'>\n            <VideoJS options={videoJsOptions} />\n          </div>\n        </div>\n        <div className='col-12 col-lg-3'>\n          <Chat />\n        </div>\n        <div className='col-1'>\n          <button className='btn btn-danger' onClick={handleLogout}>\n            Log out\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nLivestream.propTypes = {};\n\nexport default Livestream;\n","import React, { useState, useEffect } from 'react';\nimport { Redirect, useHistory } from 'react-router-dom';\nimport { useForm, UseFormProps, SubmitHandler } from 'react-hook-form';\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport schema from './schema.config';\nimport firebase from 'firebase';\nimport 'firebase/auth';\n\nfunction Register(props) {\n  const formOptions = {\n    mode: 'onSubmit',\n    reValidateMode: 'onChange',\n    resolver: yupResolver(schema),\n  };\n\n  const history = useHistory();\n\n  const { handleSubmit, register } = useForm(formOptions);\n\n  const [loading, setLoading] = useState(false);\n\n  const prepareRequest = (formData) => {\n    const { password, username } = formData;\n    const reqData = {\n      username,\n      password,\n    };\n\n    makeRequest(reqData);\n  };\n\n  const makeRequest = async (reqData) => {\n    const { username, password } = reqData;\n    const auth = firebase.auth();\n\n    auth\n      .createUserWithEmailAndPassword(username, password)\n      .then((userCredential) => {\n        const user = userCredential.user;\n        history.push('/');\n      })\n      .catch((error) => {\n        console.error(error);\n      });\n  };\n\n    const [authentication, setAuthState] = useState({\n    authenticated: false,\n    initializing: true,\n  });\n\n  useEffect(\n    () =>\n      firebase.auth().onAuthStateChanged((user) => {\n        console.log('USER', user);\n        if (user) {\n          setAuthState({\n            authenticated: true,\n            initializing: false,\n          });\n        } else {\n          setAuthState({\n            authenticated: false,\n            initializing: false,\n          });\n        }\n      }),\n    [setAuthState]\n  );\n\n  if (authentication.authenticated) {\n    return <Redirect to='/' />;\n  }\n\n  return (\n    <div className='container'>\n      <h1>Join our community</h1>\n      <form\n        action=''\n        onSubmit={handleSubmit(prepareRequest)}\n        className='mt-3 col-12 col-md-5 mx-auto'\n      >\n        <div className='form-group'>\n          <label htmlFor='username'>Email</label>\n          <input\n            {...register('username')}\n            type='text'\n            name='username'\n            className={`form-control rounded mt-2`}\n            id='username'\n          />\n        </div>\n\n        <div className='form-group'>\n          <label htmlFor='password'>Password</label>\n          <input\n            {...register('password', {\n              minLength: {\n                value: 6,\n                message: 'Password length must be at least 6 characters',\n              },\n            })}\n            type='password'\n            name='password'\n            className={`form-control rounded mt-2`}\n            id='password'\n          />\n        </div>\n\n        <button className='btn btn-primary mt-4 w-100' type='submit'>\n          Register\n        </button>\n      </form>\n    </div>\n  );\n}\n\nRegister.propTypes = {};\n\nexport default Register;\n","import React, { useState, useEffect } from 'react';\nimport { BrowserRouter, Switch, Route, Redirect } from 'react-router-dom';\nimport { Login, Livestream, Register } from '../pages';\nimport getFirebase from './firebase';\n\nexport const ROUTES = [\n  {\n    path: '/',\n    key: 'ROOT',\n    exact: true,\n    protected: true,\n    component: () => <Livestream />,\n  },\n  {\n    path: '/login',\n    key: 'LOGIN',\n    exact: true,\n    component: () => <Login />,\n  },\n  {\n    path: '/register',\n    key: 'REGISTER',\n    exact: true,\n    component: () => <Register />,\n  },\n  {\n    path: '/admin',\n    key: 'ADMIN',\n    exact: true,\n    protected: true,\n    component: () => <Livestream />,\n  },\n];\n\nexport function RenderRoutes({ routes }) {\n  const firebase = getFirebase();\n\n  const [authentication, setAuthState] = useState({\n    authenticated: false,\n    initializing: true,\n  });\n\n  useEffect(\n    () =>\n      firebase.auth().onAuthStateChanged((user) => {\n        console.log('USER', user);\n        if (user) {\n          setAuthState({\n            authenticated: true,\n            initializing: false,\n          });\n        } else {\n          setAuthState({\n            authenticated: false,\n            initializing: false,\n          });\n        }\n      }),\n    [setAuthState]\n  );\n\n  if (authentication.initializing) {\n    return <div>Loading...</div>;\n  }\n\n  return (\n    <BrowserRouter>\n      <Switch>\n        {routes.map((route, i) => {\n          if (route.protected) {\n            return (\n              <Route\n                path={route.path}\n                exact={route.exact}\n                render={(props) =>\n                  !authentication.authenticated ? (\n                    <Redirect to='/login' />\n                  ) : (\n                    <route.component {...props} />\n                  )\n                }\n              />\n            );\n          }\n          return (\n            <Route\n              path={route.path}\n              exact={route.exact}\n              render={(props) => <route.component {...props} />}\n            />\n          );\n        })}\n        <Route component={() => <h1>404 - Not Found!</h1>} />\n      </Switch>\n    </BrowserRouter>\n  );\n}\n","import { useEffect } from 'react';\nimport './App.scss';\nimport { ROUTES, RenderRoutes } from './utils/routes';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport UserContextProvider from './providers/UserContext';\n\nfunction App() {\n  return (\n    <div className='App'>\n      <UserContextProvider>\n        <RenderRoutes routes={ROUTES}></RenderRoutes>\n      </UserContextProvider>\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}