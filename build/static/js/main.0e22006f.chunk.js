(this["webpackJsonplarin.cam"]=this["webpackJsonplarin.cam"]||[]).push([[0],{146:function(e,t,n){},251:function(e,t,n){},256:function(e,t){},294:function(e,t,n){},296:function(e,t,n){},298:function(e,t,n){"use strict";n.r(t);var c,a=n(3),s=n.n(a),r=n(130),i=n.n(r),o=(n(146),n(24)),u=n(12),l=n(52),j=n(19),d=n(11),b=n.n(d),m=n(20),f=n(34),h=n(66),O=n(67),p=O.a().shape({username:O.b().email().required("Username is a required field."),password:O.b().min(6,"Password must be at least 6 characters long.").required("Password is a required field.")}),x=n(46),v={apiKey:"AIzaSyCDN0Hii6Mznt2Y_DaRprMWVn7kwR9-xlY",authDomain:"larincam.firebaseapp.com",projectId:"larincam",storageBucket:"larincam.appspot.com",messagingSenderId:"70794209044",appId:"1:70794209044:web:1f0ccefcdfb498f5fcc401"};function g(){return"undefined"!==typeof window?c||(c=x.a.initializeApp(v)):null}var w=n(6),N=Object(a.createContext)(null);var y=function(e){var t=e.children,n=Object(a.useState)(null),c=Object(u.a)(n,2),s=c[0],r=c[1];return Object(w.jsx)(N.Provider,{value:{currentUser:s,setCurrentUser:r},children:t})};n(251);var S=function(e){var t=Object(a.useContext)(N),n=Object(j.g)(),c=g(),s={mode:"onSubmit",reValidateMode:"onChange",resolver:Object(h.a)(p)},r=Object(f.d)(s),i=r.handleSubmit,l=r.register,d=Object(a.useState)(!1),O=Object(u.a)(d,2),x=(O[0],O[1]),v=function(){var e=Object(m.a)(b.a.mark((function e(a){var s,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:x(!0),s=a.username,r=a.password,c.auth().signInWithEmailAndPassword(s,r).then((function(e){x(!1),console.log(e);var c=e.user;t.setCurrentUser(c),n.push("/")})).catch((function(e){console.error(e)}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=Object(a.useState)({authenticated:!1,initializing:!0}),S=Object(u.a)(y,2),C=S[0],A=S[1];return Object(a.useEffect)((function(){return c.auth().onAuthStateChanged((function(e){console.log("USER",e),A(e?{authenticated:!0,initializing:!1}:{authenticated:!1,initializing:!1})}))}),[A]),C.authenticated?Object(w.jsx)(j.a,{to:"/"}):Object(w.jsx)("div",{className:"container",children:Object(w.jsxs)("form",{action:"",onSubmit:i((function(e){var t=e.password,n=e.username;v({username:n,password:t})})),className:"mt-3 col-12 col-md-5 mx-auto sign-in-form",children:[Object(w.jsx)("h1",{children:"P\u0159ihl\xe1\u0161en\xed"}),Object(w.jsxs)("div",{className:"form-group",children:[Object(w.jsx)("label",{htmlFor:"username",children:"Email"}),Object(w.jsx)("input",Object(o.a)(Object(o.a)({},l("username")),{},{type:"text",name:"username",className:"form-control rounded mt-2",id:"username"}))]}),Object(w.jsxs)("div",{className:"form-group mt-2",children:[Object(w.jsx)("label",{htmlFor:"password",children:"Heslo"}),Object(w.jsx)("input",Object(o.a)(Object(o.a)({},l("password",{minLength:{value:6,message:"Password length must be at least 6 characters"}})),{},{type:"password",name:"password",className:"form-control rounded mt-2",id:"password"}))]}),Object(w.jsx)("button",{className:"btn btn-primary mt-4 w-100",type:"submit",children:"P\u0159ihl\xe1sit se"})]})})},C=n(141),A=(n(267),n(268),function(e){var t=s.a.useRef(null),n=e.options,c=function(e){return Object(w.jsx)("div",{"data-vjs-player":!0,children:Object(w.jsx)("video",{ref:t,className:"video-js vjs-theme-city vjs-big-play-centered",crossOrigin:"anonymous"})})};return s.a.useEffect((function(){var e,c=t.current;return c&&(e=Object(C.a)(c,n,(function(){}))),function(){e&&e.dispose()}}),[n]),Object(w.jsx)(c,{})}),E=n(14),I=n(140);var U=function(e){var t=Object(a.useState)(null),n=Object(u.a)(t,2),c=n[0],s=n[1];Object(a.useEffect)((function(){var e=Object(I.io)("wss://chat.larin.cam");return s(e),function(){return e.close()}}),[s]),Object(a.useEffect)((function(){var e=g().auth().currentUser;h(e.email)}),[]);var r=Object(a.useState)(!1),i=Object(u.a)(r,2),o=i[0],l=i[1],j=Object(a.useState)(!1),d=Object(u.a)(j,2),b=(d[0],d[1],Object(a.useState)("")),m=Object(u.a)(b,2),f=m[0],h=m[1],O=Object(a.useState)([]),p=Object(u.a)(O,2),x=p[0],v=p[1],N=Object(a.useState)(0),y=Object(u.a)(N,2),S=y[0],C=y[1],A=Object(a.useRef)();c&&(c.emit("add user",f),c.on("login",(function(e){C(e.numUsers),l(!0)})),c.on("new message",(function(e){U(e)})),c.on("user joined",(function(e){C(e.numUsers)})),c.on("user left",(function(e){C(e.numUsers)})),c.on("disconnect",(function(){})),c.on("reconnect",(function(){f&&c.emit("add user",f)})));var U=function(e){var t=new Date,n=t.toLocaleString("cs").split(" ");v([].concat(Object(E.a)(x),[{username:e.username,message:e.message,time:n[n.length-1]}]))},k=Object(a.useRef)(null);return Object(a.useEffect)((function(){k.current.scrollIntoView({behavior:"smooth"})}),[x]),Object(w.jsxs)("div",{className:"chat",children:[Object(w.jsxs)("div",{className:"chat-header d-flex justify-content-between",children:[Object(w.jsx)("span",{children:"CHAT"}),Object(w.jsx)("span",{children:"".concat(S,1===S?" DIV\xc1K":S<=4?" DIV\xc1CI":" DIV\xc1K\u016e")})]}),Object(w.jsxs)("div",{className:"chat-body",children:[x.map((function(e){var t=e.username,n=e.message;return e.time,e.photoUrl,Object(w.jsxs)("div",{className:"message d-flex mb-3 align-items-center",children:[Object(w.jsx)("img",{src:"https://www.makeyoutubevideo.com/assets/img/avatar.jpg",alt:"",className:"me-2"}),Object(w.jsxs)("div",{className:"d-flex flex-column align-items-start",children:[Object(w.jsx)("span",{className:"username",children:t}),Object(w.jsx)("p",{className:"message-text",children:n})]})]})})),Object(w.jsx)("div",{ref:k})]}),Object(w.jsx)("div",{className:"chat-footer",children:Object(w.jsx)("form",{action:"",onSubmit:function(e){e.preventDefault();var t=A.current.value;t&&o&&(A.current.value="",U({username:f,message:t}),c.emit("new message",t))},children:Object(w.jsxs)("div",{className:"form-group d-flex",children:[Object(w.jsx)("input",{type:"text",ref:A,placeholder:"Zpr\xe1va",className:"w-100"}),Object(w.jsx)("button",{className:"btn btn-primary",children:"SEND"})]})})})]})};n(294);var k=function(e){var t=g(),n=Object(a.useState)("null"),c=Object(u.a)(n,2),s=c[0],r=c[1];Object(a.useEffect)((function(){t.auth().currentUser.getIdToken(!0).then((function(e){fetch("https://larin.cam/issue-stream-url",{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"*","Access-Control-Allow-Headers":"*"}}).then((function(e){e.json().then((function(e){r(e.data)}))}))})).catch(function(){var e=Object(m.a)(b.a.mark((function e(n){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.auth().signOut();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]);var i=function(){var e=Object(m.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.auth().signOut();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();console.log("SRC",s);var o={autoplay:!0,controls:!0,responsive:!0,liveui:!0,fluid:!0,sources:[{src:s,type:"application/x-mpegURL"}]};return s?Object(w.jsxs)("div",{className:"container",children:[Object(w.jsxs)("div",{className:"row mt-3",children:[Object(w.jsx)("div",{className:"col-12 col-lg-9",children:Object(w.jsx)("div",{className:"video-wrapper",children:Object(w.jsx)(A,{options:o})})}),Object(w.jsx)("div",{className:"col-12 col-lg-3 mt-3 mt-lg-0",children:Object(w.jsx)(U,{})})]}),Object(w.jsx)("div",{className:"text-start mt-3",children:Object(w.jsx)("button",{className:"btn btn-danger text-left",onClick:i,children:"Log out"})})]}):Object(w.jsx)("div",{children:"Loading..."})};n(295),n(296);var z=[{path:"/",key:"ROOT",exact:!0,protected:!0,component:function(){return Object(w.jsx)(k,{})}},{path:"/login",key:"LOGIN",exact:!0,component:function(){return Object(w.jsx)(S,{})}}];function R(e){var t=e.routes,n=g(),c=Object(a.useState)({authenticated:!1,initializing:!0}),s=Object(u.a)(c,2),r=s[0],i=s[1];return Object(a.useEffect)((function(){return n.auth().onAuthStateChanged((function(e){console.log("USER",e),i(e?{authenticated:!0,initializing:!1}:{authenticated:!1,initializing:!1})}))}),[i]),r.initializing?Object(w.jsx)("div",{children:"Loading..."}):Object(w.jsx)(l.a,{children:Object(w.jsxs)(j.d,{children:[t.map((function(e,t){return e.protected?Object(w.jsx)(j.b,{path:e.path,exact:e.exact,render:function(t){return r.authenticated?Object(w.jsx)(e.component,Object(o.a)({},t)):Object(w.jsx)(j.a,{to:"/login"})}}):Object(w.jsx)(j.b,{path:e.path,exact:e.exact,render:function(t){return Object(w.jsx)(e.component,Object(o.a)({},t))}})})),Object(w.jsx)(j.b,{component:function(){return Object(w.jsx)("h1",{children:"404 - Not Found!"})}})]})})}n(297);var D=function(){return Object(w.jsx)("div",{className:"App",children:Object(w.jsx)(y,{children:Object(w.jsx)(R,{routes:z})})})};i.a.render(Object(w.jsx)(D,{}),document.getElementById("root"))}},[[298,1,2]]]);
//# sourceMappingURL=main.0e22006f.chunk.js.map